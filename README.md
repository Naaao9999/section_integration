## 産業連関表 部門統合ツール（Google Colab版）の使い方
このプログラムは、産業連関分析の前処理で手間のかかる **「部門統合（複数の産業を一つにまとめる作業）」** を自動化するツールです。
Pythonの知識がなくても、Google Colab上で設定を数箇所書き換えるだけで実行できます。

### 手順
読み込むファイルに合わせて、プログラム内の `PATTERN` を以下の4つから選択してください。
| パターン | ファイル形式 | 構造 |
| :--- | :--- | :--- |
| **A** | **Excel** | 1行目・1列目が「部門名」 |
| **B** | **CSV(Shift-JIS)** | 1行目・1列目が「部門名」 |
| **C** | **Excel** | 1-2行目/列が「部門番号・名称」の2段構成 |
| **D** | **CSV(Shift-JIS)** | 1-2行目/列が「部門番号・名称」の2段構成 |

> **注意:** 上記に当てはまらない場合（ヘッダーが3行以上ある、先頭に余計は空白行列がある等）は、あらかじめExcel上で不要な行列を削除しておいてください。また、一般的に、Excelで開いた際に日本語の産業名で表示されているCSVはShift-jisです。


1.  **初期設定の入力**
    * `PATTERN`: 上記の "A"〜"D" を入力。
    * `TARGET_SECTORS`: 統合したい部門名をダブルクオーテーション内に形式 `["農業", "林業"]` で入力。
    * `NEW_SECTOR_NAME`: 統合後の新しい名称（例： `"農林水産業"`）を入力。
2.  **実行**
    * 上部の「**すべてのセルを実行**」をクリック。
3.  **アップロードと保存**
    * 画面下部に表示される「ファイルを選択」ボタンから対象ファイルを選択。
    * 数秒後に「〜_統合済み.xlsx（またはcsv）」が自動でダウンロードされます。

4.  複数回部門統合したい場合には、複数回実行してください（今後一回でできる機能改善も検討中です。）

### 注意点

*   生産額におけるコンマの有無は自動調整されます。
*   PATTERNがCおよびDの場合は、統合後の部門番号はもともとの小さいほうの番号が適用されます。
*   エラーが発生した場合は、ページ自体を再読み込みし、再度「すべてのセルを実行」を押してください。
*   誤って処理部を変更した場合でも、再読み込みすれば元に戻ります。

